<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Availability Checker</title>

<style>
body {
  background: #f5f5f5;
  margin: 0;
  padding: 20px;
  font-family: "Inter", sans-serif;
}

/* WIDGET */
.availability-widget {
  max-width: 420px;
  margin: auto;
  padding: 18px;
  background: #ffffff;
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

/* TITLE */
.availability-widget h2 {
  text-align: center;
  font-size: 22px;
  margin-bottom: 20px;
  font-weight: 600;
}

/* LABELS */
.availability-widget label {
  font-size: 15px;
  margin-top: 12px;
  display: block;
  font-weight: 500;
}

/* DATE INPUTS */
.availability-widget input[type="date"] {
  width: 100%;
  padding: 12px;
  margin-top: 6px;
  border-radius: 10px;
  border: 1px solid #d1d5db;
  font-size: 16px;
  outline: none;
}

/* BUTTON */
#checkBtn {
  width: 100%;
  padding: 14px;
  margin-top: 22px;
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 12px;
  font-size: 17px;
  font-weight: 600;
  cursor: pointer;
  transition: 0.2s;
}

#checkBtn:hover {
  background: #2563eb;
}

/* RESULTS */
#results {
  margin-top: 22px;
}

.room {
  padding: 14px;
  border-radius: 12px;
  margin-bottom: 12px;
  font-size: 16px;
  font-weight: 500;
}

.available {
  background: #d1fae5;
  border: 1px solid #10b981;
}

.booked {
  background: #fee2e2;
  border: 1px solid #ef4444;
}
</style>
</head>


<body>

<div class="availability-widget">
  <h2>Check Availability</h2>

  <label>Check-in</label>
  <input type="date" id="checkin">

  <label>Check-out</label>
  <input type="date" id="checkout">

  <button id="checkBtn">Check Availability</button>

  <div id="results"></div>
</div>


<script>
// ✔️ Your Apps Script API URL
const sheetURL = "https://script.google.com/macros/s/AKfycbwH1_S9bIQ8YtV5OihsxJknCXGuTmHTiU4Sk_7EW9jWT2QHFuTEZ0MGnRa7E1tOhzh1pQ/exec"; 

// When check-in selected → force checkout to be after
document.getElementById("checkin").addEventListener("change", e => {
  let checkin = e.target.value;
  document.getElementById("checkout").min = checkin;
});

// Button click → check availability
document.getElementById("checkBtn").addEventListener("click", async () => {
  
  const checkin = document.getElementById("checkin").value;
  const checkout = document.getElementById("checkout").value;

  if (!checkin || !checkout) {
    alert("Please select both dates.");
    return;
  }

  // Fetch Google Sheet data
  const res = await fetch(sheetURL);
  const data = await res.json();
  const rows = data.values;

  // Room columns: C, D, E, F → 2,3,4,5
  const roomIndexes = [2, 3, 4, 5];

  let resultsHTML = "";

  // Find start & end row index by matching dates in Column A
  const start = rows.findIndex(r => r[0] === checkin);
  const end = rows.findIndex(r => r[0] === checkout);

  if (start === -1 || end === -1) {
    document.getElementById("results").innerHTML =
      "<p style='color:red'>Selected dates are outside database range.</p>";
    return;
  }

  roomIndexes.forEach(idx => {
    let roomName = rows[0][idx];
    let isAvailable = true;

    for (let i = start; i < end; i++) {
      if (rows[i][idx] && rows[i][idx] !== "") {
        isAvailable = false;
        break;
      }
    }

    resultsHTML += `
      <div class="room ${isAvailable ? "available" : "booked"}">
        <strong>${roomName}</strong><br>
        ${isAvailable ? "Available ✓" : "Booked ✕"}
      </div>
    `;
  });

  document.getElementById("results").innerHTML = resultsHTML;
});
</script>


</body>
</html>
